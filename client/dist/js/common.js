"use strict";var commonObj={weeks:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],timer:null,progressPsition:"",maxPlayWidth:372,audioTimePos:{l:-4,t:-6,r:372,b:-4},audioVolumePos:{l:-4,t:-6,r:82,b:-4},maxVolumeWidth:82,playData:{src:"/src/source/前世今生-文武贝钢琴版.mp3",name:"至尊宝",singer:"徐良/杨威",coverImg:"/dist/images/avatar.jpg",volume:.5,loop:!1,ended:!1,muted:!1,currentTime:0,duration:0},data:{},TemplateEngine:function(t,e){for(var n=/<%([^%>]+)?%>/g,o=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,r="var r=[];\n",a=0,i=function t(e,n){return r+=n?e.match(o)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",t};match=n.exec(t);)i(t.slice(a,match.index))(match[1],!0),a=match.index+match[0].length;return i(t.substr(a,t.length-a)),r+='return r.join("");',new Function(r.replace(/[\r\t\n]/g,"")).apply(e)},getTpl:function(t){return $.ajax({type:"GET",url:t,async:!1}).responseText},getAudioInfo:function(t,e){var n=t.duration||0,o=parseInt(n/60),r=parseInt(n%60),a=t.currentTime,i=60*o+r,s=(o=o<10?"0"+o:o)+":"+(r=r<10?"0"+r:r),u=(o=59<Math.round(a)?Math.round(a/60)<10?"0"+parseInt(a/60):Math.round(a/60):"00")+":"+(r=60==(r=parseInt(a%60)<10?"0"+parseInt(a%60):parseInt(a%60))?"00":r);this.playData.src=t.src,this.playData.volume=t.volume,this.playData.ended=t.ended,this.playData.muted=t.muted,this.playData.curStr=u,this.playData.endStr=s,this.playData.duration=i,this.playData.currentTime=parseInt(a),e&&e(parseInt(a),u,s,i)},initPlayer:function(t,e){t.addEventListener("timeupdate",function(){commonObj.getAudioInfo(t,e)}),t.addEventListener("loadedmetadata",function(){commonObj.getAudioInfo(t,e)}),t.addEventListener("ended",function(){commonObj.getAudioInfo(t,e),clearInterval(commonObj.timer)})}};window.layoutTemp=commonObj.getTpl("/template/layout.html"),window.contentTemp=commonObj.getTpl("/template/index.html");var audioPlayer=$("#play-audio")[0];$.extend({filterPlayCount:function(t){return t=1e4<t?parseInt(t/1e4)+"万":t},filterDruationTime:function(t){var e=Math.floor(t/60/1e3),n=Math.round(t/1e3%60);return(e=e<10?"0"+e:e)+":"+(n=n<10?"0"+n:n)},$route:{},$router:{push:function(t,e){var n=$("#iframe-pages"),o="";if(e){for(var r in o="?",e)o+=r+"="+e[r]+"&";o=o.slice(0,o.length-1)}var a="/src/pages"+t+".html"+o;$.$store.set("route",{path:t,query:e}),$.$store.set("url",a),n.attr("src",a),$(window.parent.document).find("#iframe-pages").attr("src",a)},replace:function(){$("#iframe-pages")[0].contentWindow.location.replace(path)},go:function(t){var e=0<arguments.length&&void 0!==t?t:1;$("#iframe-pages")[0].contentWindow.history.go(e)},forward:function(){var t=$("#iframe-pages")[0].contentWindow;return t.history.forward(),t.history.length},back:function(){var t=$("#iframe-pages")[0].contentWindow;return t.history.back(),t.history.length}},$store:{state:{},getters:function(){return(void 0).state},get:function(t){var e=JSON.parse(localStorage.getItem(t));if(null!=e){if(!(null!=e.expirse&&e.expirse<(new Date).getTime()))return this.state.key||e.value;this.state.key=null,this.remove(t)}return null},set:function(t,e,n){var o={value:e,expirse:new Date(n).getTime()};localStorage.setItem(t,JSON.stringify(o)),this.state.key=e},remove:function(t){window.localStorage.removeItem(t),this.state.key=null},action:{},mutations:{}}}),$.fn.extend({drag:function(i){var s=this,u=i.target||s,l=i.site||{},c=i.fn,m=i.cancelElem,d=document.documentElement.clientWidth||document.body.clientWidth,p=document.documentElement.clientHeight||document.body.clientHeight,l=l||{},s=s[0],u=u[0],f=l.n||0,h=l.l||0,g=l.r||0==l.r?l.r:d-u.offsetWidth,v=l.t||0,y=l.b||0==l.b?l.b:p-u.offsetHeight;s.onmousedown=function(o){g=l.r||0==l.r?l.r:d-u.offsetWidth,y=l.b||0==l.b?l.b:p-u.offsetHeight;var t=o||event,r=t.clientX-u.offsetLeft,a=t.clientY-u.offsetTop;if(o.stopPropagation(),$(o.target).closest(m).length)return!0;function e(t){var e=t||event,n=e.clientX-r,o=e.clientY-a;t.stopPropagation(),n<=h+f&&(n=0),g-f<=n&&(n=g),o<=v+f&&(o=0),y-f<=o&&(o=y),c&&c({left:n,top:o}),$(s).find(".point").show(),$(".js-mini-music-box").find(".volume").hide(),u.style.left=n+"px",u.style.top=o+"px"}function n(){var t=o||event,e=t.clientX-r,n=t.clientY-a;s.setCapture&&s.releaseCapture(),i.end&&i.end({left:e,top:n}),this.onmousemove=null,this.onmouseup=null,this.onclick=null}return s.setCapture?(s.onmousemove=e,s.onmouseup=n,s.setCapture()):(document.onmousemove=e,document.onmouseup=n),this}},render:function(t,e,n){var o=t.text();n?(this.html(n),this.append(template.render(o,e))):this.html(template.render(o,e))}}),$(function(){null!==$.$store.get("route")&&($.$route={path:$.$store.get("route").path,query:$.$store.get("route").query})});