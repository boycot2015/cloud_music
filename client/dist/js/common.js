var commonObj={timer:null,progressPsition:"",maxPlayWidth:372,audioTimePos:{l:-4,t:-6,r:372,b:-4},audioVolumePos:{l:-4,t:-6,r:82,b:-4},maxVolumeWidth:82,playData:{src:"/src/source/前世今生-文武贝钢琴版.mp3",name:"至尊宝",singer:"徐良/杨威",coverImg:"/dist/images/avatar.jpg",volume:.5,loop:!1,ended:!1,muted:!1,currentTime:0,duration:0},data:{},TemplateEngine:function(t,e){for(var n=/<%([^%>]+)?%>/g,o=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,a="var r=[];\n",r=0,i=function(t,e){return a+=e?t.match(o)?t+"\n":"r.push("+t+");\n":""!=t?'r.push("'+t.replace(/"/g,'\\"')+'");\n':"",i};match=n.exec(t);)i(t.slice(r,match.index))(match[1],!0),r=match.index+match[0].length;return i(t.substr(r,t.length-r)),a+='return r.join("");',new Function(a.replace(/[\r\t\n]/g,"")).apply(e)},getTpl:function(t){return $.ajax({type:"GET",url:t,async:!1}).responseText},getAudioInfo:function(t,e){var n=t.duration||0,o=parseInt(n/60),a=parseInt(n%60),r=t.currentTime,i=60*o+a,u=(o=o<10?"0"+o:o)+":"+(a=a<10?"0"+a:a),s=(o=59<Math.round(r)?Math.round(r/60)<10?"0"+parseInt(r/60):Math.round(r/60):"00")+":"+(a=60==(a=parseInt(r%60)<10?"0"+parseInt(r%60):parseInt(r%60))?"00":a);this.playData.src=t.src,this.playData.volume=t.volume,this.playData.ended=t.ended,this.playData.muted=t.muted,this.playData.curStr=s,this.playData.endStr=u,this.playData.duration=i,this.playData.currentTime=parseInt(r),e&&e(parseInt(r),s,u,i)},initPlayer:function(t,e,n){t.addEventListener("timeupdate",function(){commonObj.getAudioInfo(t,e)}),t.addEventListener("loadedmetadata",function(){commonObj.getAudioInfo(t,e)}),t.addEventListener("ended",function(){commonObj.getAudioInfo(t,e),clearInterval(commonObj.timer)})},drag:function(i){var u=i.obj,s=i.target||i.obj,l=i.site||{},m=i.fn,c=i.cancelElem,d=document.documentElement.clientWidth||document.body.clientWidth,p=document.documentElement.clientHeight||document.body.clientHeight,f=(l=l||{}).n||0,h=l.l||0,g=(l.r||0==l.r||s.offsetWidth,0),v=l.t||0,b=(l.b||0==l.b||s.offsetHeight,0);u.onmousedown=function(o){g=l.r||0==l.r?l.r:d-s.offsetWidth,b=l.b||0==l.b?l.b:p-s.offsetHeight;var t=o||event,a=t.clientX-s.offsetLeft,r=t.clientY-s.offsetTop;if(o.stopPropagation(),$(o.target).closest(c).length)return!0;function e(t){var e=t||event,n=e.clientX-a,o=e.clientY-r;t.stopPropagation(),n<=h+f&&(n=0),g-f<=n&&(n=g),o<=v+f&&(o=0),b-f<=o&&(o=b),m&&m({left:n,top:o}),$(u).find(".point").show(),$(".js-mini-music-box").find(".volume").hide(),s.style.left=n+"px",s.style.top=o+"px"}function n(){var t=o||event,e=t.clientX-a,n=t.clientY-r;u.setCapture&&u.releaseCapture(),i.end&&i.end({left:e,top:n}),this.onmousemove=null,this.onmouseup=null,this.onclick=null}return u.setCapture?(u.onmousemove=e,u.onmouseup=n,u.setCapture()):(document.onmousemove=e,document.onmouseup=n),!1}}},layoutTemp=commonObj.getTpl("/template/layout.html");