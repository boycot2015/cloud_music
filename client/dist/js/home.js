"use strict";$(function(){var a={swiperOption:{slidesPerView:1,effect:"coverflow",centeredSlides:!0,coverflowEffect:{rotate:0,stretch:100,depth:50,modifier:3,slideShadows:!1},autoplay:{delay:5e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},loop:!0,navigation:{nextEl:".button-next",prevEl:".button-prev"},speed:500},constantTemp:{recommend:""},tabMenu:[{name:"个性推荐",type:"home"},{name:"歌单",type:"cate"},{name:"主播电台",type:"dj"},{name:"排行榜",type:"ph"},{name:"歌手",type:"singer"},{name:"最新音乐",type:"newest"}],setLocal:function(){var t=$.$store.get("banner"),e=$.$store.get("mvList"),a=$.$store.get("recommendList"),n=$.$store.get("djList"),s=$.$store.get("newestList"),i=$.$store.get("privatecontentList");return null!==t&&$(".swiper-wrapper").render($(layoutTemp).find("#bannerTemp"),t),null!==e&&$(".tab-home-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),a,this.constantTemp.recommend),null!==a&&$(".dj-list").render($(layoutTemp).find("#gridListTemp"),n),null!==n&&$(".mv-list").render($(layoutTemp).find("#gridListTemp"),e),null!==s&&$(".newest-list").render($(layoutTemp).find("#gridListTemp"),s),null!==i&&$(".privatecontent-list").render($(layoutTemp).find("#gridListTemp"),i),t||e||a||n||s||i},init:function(){$(".tab-home-content .recommend-list").find(".date-text").html((new Date).getDate()).siblings(".week").html(commonObj.weeks[(new Date).getDay()]),this.constantTemp.recommend=$(".tab-home-content .recommend-list").html(),$(".music-home .tab-list").render($(contentTemp).find("#tabsTemp"),{list:this.tabMenu}),null==this.setLocal()?(this.getBanner(),this.getRecommend(),this.getPrivatecontent(),this.getTopSong(),this.getMVList(),this.getDjRecommend()):new Swiper(".swiper-container",a.swiperOption),this.onShow()},getBanner:function(){$.ajax({type:"get",dataType:"json",data:{json:1},url:apiUrls.home.banner,success:function(t){$(".swiper-wrapper").render($(layoutTemp).find("#bannerTemp"),{list:t.banners}),$.$store.set("banner",{list:t.banners},(new Date).getTime()+6e4),new Swiper(".swiper-container",a.swiperOption)}})},getRecommend:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.personalized,success:function(t){var e=t.result;e.forEach(function(t){t.playCount=$.filterPlayCount(t.playCount)}),$(".tab-home-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),{list:e},a.constantTemp.recommend),$.$store.set("recommendList",{list:e},(new Date).getTime()+6e4)}})},getPrivatecontent:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.privatecontent,success:function(t){var e=t.result;$(".privatecontent-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("privatecontentList",{list:e},(new Date).getTime()+6e4)}})},getTopSong:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.topSong,success:function(t){var e=[{ftype:0,list:(e=t.data.slice(0,10)).slice(0,5)},{ftype:0,list:e.slice(5,10)}];$(".newest-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("newestList",{list:e},(new Date).getTime()+6e4)}})},getMVList:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.mv,success:function(t){var e;200==t.code&&(e=t.result.slice(0,3),$(".mv-list").render($(layoutTemp).find("#gridListTemp"),{list:e,category:t.category}),$.$store.set("mvList",{list:e,category:t.category},(new Date).getTime()+6e4))}})},getDjRecommend:function(){$.ajax({type:"get",dataType:"json",data:{limit:5},url:apiUrls.home.djrecommend,success:function(t){var e;200==t.code&&(e=t.djRadios.slice(0,5),$(".dj-list").render($(layoutTemp).find("#gridListTemp"),{list:e,category:t.category}),$.$store.set("djList",{list:e,category:t.category},(new Date).getTime()+6e4))}})},onShow:function(){$(document).on("click",".js-list-detail",function(){var t=$(this).attr("data-id"),e=$(this).attr("data-type"),a=$(this).attr("data-ctype");$.$router.push("/songs/list",{id:t,type:e,ctype:a})}),$(".tab-content .recommend .more").click(function(){$(".js-tab-item").eq(1).click()}),$(".tab-content .newest-song .more").click(function(){$(".js-tab-item").eq(5).click()}),$(".tab-content .recommend .more").click(function(){$(".js-tab-item").eq(1).click()}),$(".tab-content .recommend .more").click(function(){$(".js-tab-item").eq(1).click()})}},s={data:{query:{}},setLocal:function(){var t=$.$store.get("hotCateList"),e=$.$store.get("cateList"),a=$.$store.get("songCateList");return null!==t&&$(".tab-cate-content .tags .cates").render($(contentTemp).find("#hotCateTemp"),{data:t}),null!==a&&$(".tab-cate-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),a,this.constantTemp.recommend),null!==e&&$(".mask-cate").render($(contentTemp).find("#cateListTemp"),{data:e}),t&&e&&a},constantTemp:{recommend:""},init:function(){this.constantTemp.recommend=$(".tab-cate-content .recommend-list").html(),this.onShow()},getCateList:function(){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.song.catlist,success:function(s){200==s.code&&function(){var a=[],t=(s.sub,s.all),e=s.categories;for(var n in s.categories)!function(e){a[e]=[],s.sub.map(function(t){t.category==e&&a[e].push(t)})}(n);s.subs=a,$(".tab-cate-content .mask-cate").render($(contentTemp).find("#cateListTemp"),{data:{subs:a,all:t,categories:e}}),$.$store.set("cateList",s,(new Date).getTime()+5e3)}()}})},gethotCate:function(){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.song.hotCate,success:function(t){200==t.code&&($(".tab-cate-content .tags .cates").render($(contentTemp).find("#hotCateTemp"),{data:t}),$.$store.set("hotCateList",t,(new Date).getTime()+5e3))}})},getRecommend:function(a,t){$.ajax({type:"get",dataType:"json",data:{limit:39,order:"hot",cat:t,offset:a},url:apiUrls.song.topPlaylist,success:function(t){a=a||1;var e=t.playlists;console.log(t,"apiUrl.personalizedTemp"),e.forEach(function(t){t.playCount=$.filterPlayCount(t.playCount)}),s.initPage(t.total),$(".tab-cate-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),{list:e},s.constantTemp.recommend),$.$store.set("songCateList",{list:e},(new Date).getTime()+5e3)}})},initPage:function(t){$("#cate-page").Page({totalPages:t,liNums:7,activeClass:"activP",firstPage:"首页",lastPage:"末页",prv:"<",next:">",hasFirstPage:!0,hasLastPage:!0,hasPrv:!0,hasNext:!0,callBack:function(t){s.getRecommend(t)}})},onShow:function(){$(document).on("click",".js-tab-item",function(){$(this).addClass("active").siblings().removeClass("active"),$(".tab-content").eq($(this).index()).show().siblings(".tab-content").hide();var t=$(this).attr("data-type");null==s.setLocal()&&"cate"==t&&(s.getCateList(),s.gethotCate(),s.getRecommend())}),$(".js-toggle-cate").click(function(){$(this).parent().siblings(".mask-cate").toggleClass("active")}),$(document).on("click",".js-cates-item",function(){var a=$(this).attr("data-cate"),n=!1;$(".js-hot-cate-item").each(function(t,e){$(e).attr("data-cate")==a&&($(e).addClass("active").siblings(".js-hot-cate-item").removeClass("active"),n=!0)}),n||$(".js-hot-cate-item").removeClass("active"),$(this).addClass("active").siblings().removeClass("active").parent().parent().parent().siblings().find(".js-cates-item").removeClass("active"),$(".btn-cate").removeClass("active"),$(".mask-cate").removeClass("active"),$(".js-hot-cate-item").find().addClass("active"),$(".js-toggle-cate .text").html(a),s.data.query.cate=a}),$(document).on("click",".js-hot-cate-item",function(){var a=$(this).attr("data-cate");$(this).addClass("active").siblings(".js-hot-cate-item").removeClass("active"),$(".btn-cate").removeClass("active"),$(".mask-cate").removeClass("active"),$(".js-cates-item").each(function(t,e){$(e).attr("data-cate")==a&&$(e).addClass("active").siblings().removeClass("active").parent().parent().parent().siblings().find(".js-cates-item").removeClass("active")}),$(".js-toggle-cate .text").html(a),s.data.query.cate=a}),$(document).on("click",".mask-cate .btn-cate",function(){var t=$(this).attr("data-cate");$(this).addClass("active"),$(".js-cates-item").removeClass("active"),$(".js-hot-cate-item").removeClass("active"),$(".mask-cate").removeClass("active"),$(".js-toggle-cate .text").html(t),s.data.query.cate=""}),$(document).on("click",function(t){$(".mask-cate").parent(".tab-content")[0].contains(t.target)||t.target.contains($(".js-toggle-cate")[0])||$(".mask-cate").removeClass("active")})}};a.init(),s.init()});