"use strict";$(function(){var n={swiperOption:{slidesPerView:1,effect:"coverflow",centeredSlides:!0,coverflowEffect:{rotate:0,stretch:100,depth:50,modifier:3,slideShadows:!1},autoplay:{delay:5e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},loop:!0,navigation:{nextEl:".button-next",prevEl:".button-prev"},speed:500},constantTemp:{recommend:""},tabMenu:[{name:"个性推荐",type:"home"},{name:"歌单",type:"cate"},{name:"主播电台",type:"dj"},{name:"排行榜",type:"ph"},{name:"歌手",type:"singer"},{name:"最新音乐",type:"newest"}],setLocal:function(){var t=$.$store.get("banner"),e=$.$store.get("mvList"),n=$.$store.get("recommendList"),i=$.$store.get("djList"),a=$.$store.get("newestList"),s=$.$store.get("privatecontentList");return null!==t&&$(".swiper-wrapper").render($(layoutTemp).find("#bannerTemp"),t),null!==e&&$(".tab-home-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),n,this.constantTemp.recommend),null!==n&&$(".dj-list").render($(layoutTemp).find("#gridListTemp"),i),null!==i&&$(".mv-list").render($(layoutTemp).find("#gridListTemp"),e),null!==a&&$(".newest-list").render($(layoutTemp).find("#gridListTemp"),a),null!==s&&$(".privatecontent-list").render($(layoutTemp).find("#gridListTemp"),s),t||e||n||i||a||s},init:function(){$(".tab-home-content .recommend-list").find(".date-text").html((new Date).getDate()).siblings(".week").html(commonObj.weeks[(new Date).getDay()]),this.constantTemp.recommend=$(".tab-home-content .recommend-list").html(),$(".music-home .tab-list").render($(contentTemp).find("#tabsTemp"),{list:this.tabMenu}),null==this.setLocal()?(this.getBanner(),this.getRecommend(),this.getPrivatecontent(),this.getTopSong(),this.getMVList(),this.getDjRecommend()):new Swiper(".swiper-container",n.swiperOption),this.onShow()},getBanner:function(){$.ajax({type:"get",dataType:"json",data:{json:1},url:apiUrls.home.banner,success:function(t){$(".swiper-wrapper").render($(layoutTemp).find("#bannerTemp"),{list:t.banners}),$.$store.set("banner",{list:t.banners},(new Date).getTime()+6e4),new Swiper(".swiper-container",n.swiperOption)}})},getRecommend:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.personalized,success:function(t){var e=t.result;e.forEach(function(t){t.playCount=$.filterPlayCount(t.playCount)}),$(".tab-home-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),{list:e},n.constantTemp.recommend),$.$store.set("recommendList",{list:e},(new Date).getTime()+6e4)}})},getPrivatecontent:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.privatecontent,success:function(t){var e=t.result;$(".privatecontent-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("privatecontentList",{list:e},(new Date).getTime()+6e4)}})},getTopSong:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.topSong,success:function(t){var e=[{ftype:0,list:(e=t.data.slice(0,10)).slice(0,5)},{ftype:0,list:e.slice(5,10)}];$(".newest-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("newestList",{list:e},(new Date).getTime()+6e4)}})},getMVList:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.mv,success:function(t){var e;200==t.code&&(e=t.result.slice(0,3),$(".mv-list").render($(layoutTemp).find("#gridListTemp"),{list:e,category:t.category}),$.$store.set("mvList",{list:e,category:t.category},(new Date).getTime()+6e4))}})},getDjRecommend:function(){$.ajax({type:"get",dataType:"json",data:{limit:5},url:apiUrls.home.djrecommend,success:function(t){var e;200==t.code&&(e=t.djRadios.slice(0,5),$(".dj-list").render($(layoutTemp).find("#gridListTemp"),{list:e,category:t.category}),$.$store.set("djList",{list:e,category:t.category},(new Date).getTime()+6e4))}})},onShow:function(){$(document).on("click",".js-list-detail",function(){var t=$(this).attr("data-id"),e=$(this).attr("data-type"),n=$(this).attr("data-ctype");$.$router.push("/songs/list",{id:t,type:e,ctype:n})}),$(".tab-content .recommend .more").click(function(){$(".js-tab-item").eq(1).click()}),$(".tab-content .newest-song .more").click(function(){$(".js-tab-item").eq(5).click()}),$(".tab-content .recommend .more").click(function(){$(".js-tab-item").eq(1).click()}),$(".tab-content .recommend .more").click(function(){$(".js-tab-item").eq(1).click()})}},i={setLocal:function(){var t=$.$store.get("hotCateList"),e=$.$store.get("cateList"),n=$.$store.get("songCateList");return null!==t&&$(".tab-cate-content .tags .cates").render($(contentTemp).find("#hotCateTemp"),{data:t}),null!==n&&$(".tab-cate-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),n,this.constantTemp.recommend),null!==e&&$(".mask-cate").html(template("cateListTemp",{data:e})),t||e||n},constantTemp:{recommend:""},init:function(){this.constantTemp.recommend=$(".tab-cate-content .recommend-list").html(),this.onShow()},getCateList:function(){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.song.catlist,success:function(a){200==a.code&&function(){var n=[],t=(a.sub,a.all),e=a.categories;for(var i in a.categories)!function(e){n[e]=[],a.sub.map(function(t){t.category==e&&n[e].push(t)})}(i);a.subs=n,$(".tab-cate-content .mask-cate").render($(contentTemp).find("#cateListTemp"),{data:{subs:n,all:t,categories:e}}),$.$store.set("cateList",a,(new Date).getTime()+1e3)}()}})},gethotCate:function(){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.song.hotCate,success:function(t){200==t.code&&(console.log(t,"hotCateTemp"),$(".tab-cate-content .tags .cates").render($(contentTemp).find("#hotCateTemp"),{data:t}),$.$store.set("hotCateList",t,(new Date).getTime()+1e3))}})},getRecommend:function(n){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.home.personalized,success:function(t){n=n||1;var e=t.result.slice(n-1,39);e.forEach(function(t){t.playCount=$.filterPlayCount(t.playCount)}),i.initPage(49),$(".tab-cate-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),{list:e},i.constantTemp.recommend),$.$store.set("songCateList",{list:e},(new Date).getTime()+1e3)}})},initPage:function(t){$("#cate-page").Page({totalPages:t,liNums:7,activeClass:"activP",firstPage:"首页",lastPage:"末页",prv:"<",next:">",hasFirstPage:!0,hasLastPage:!0,hasPrv:!0,hasNext:!0,callBack:function(t){i.getRecommend(t)}})},onShow:function(){$(document).on("click",".js-tab-item",function(){$(this).addClass("active").siblings().removeClass("active"),$(".tab-content").eq($(this).index()).show().siblings(".tab-content").hide();var t=$(this).attr("data-type");null==i.setLocal()&&"cate"==t&&(i.getCateList(),i.gethotCate(),i.getRecommend())}),$(".js-toggle-cate").click(function(){$(this).parent().siblings(".mask-cate").toggleClass("active")})}};n.init(),i.init()});