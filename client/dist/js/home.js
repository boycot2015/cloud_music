"use strict";$(function(){var e={swiperOption:{slidesPerView:1,effect:"coverflow",centeredSlides:!0,coverflowEffect:{rotate:0,stretch:100,depth:50,modifier:3,slideShadows:!1},autoplay:{delay:5e3,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},loop:!0,navigation:{nextEl:".button-next",prevEl:".button-prev"},speed:500},setLocal:function(){var t=$.$store.get("banner"),e=$.$store.get("mvList"),i=$.$store.get("recommendList"),a=$.$store.get("djList"),n=$.$store.get("newestList"),s=$.$store.get("privatecontentList");return $(".tab-home-content .recommend-list").find(".date-text").html((new Date).getDate()).siblings(".week").html(commonObj.weeks[(new Date).getDay()]),$(".swiper-wrapper").render($(layoutTemp).find("#bannerTemp"),t),$(".tab-home-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),i),$(".dj-list").render($(layoutTemp).find("#gridListTemp"),a),$(".mv-list").render($(layoutTemp).find("#gridListTemp"),e),$(".newest-list").render($(layoutTemp).find("#gridListTemp"),n),$(".privatecontent-list").render($(layoutTemp).find("#gridListTemp"),s),t||e||i||a||n||s},init:function(){null==this.setLocal()?(this.getBanner(),this.getRecommend(),this.getPrivatecontent(),this.getTopSong(),this.getMVList(),this.getDjRecommend()):new Swiper(".swiper-container",e.swiperOption),this.onShow()},getBanner:function(){$.ajax({type:"get",dataType:"json",data:{json:1},url:apiUrls.home.banner,success:function(t){$(".swiper-wrapper").render($(layoutTemp).find("#bannerTemp"),{list:t.banners}),$.$store.set("banner",{list:t.banners},(new Date).getTime()+6e4),new Swiper(".swiper-container",e.swiperOption)}})},getRecommend:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.personalized,success:function(t){var e=t.result;e.forEach(function(t){t.playCount=$.filterPlayCount(t.playCount)}),$(".tab-home-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("recommendList",{list:e},(new Date).getTime()+6e4),console.log($.$store.get("recommendList"),"apiUrl.personalizedTemp")}})},getPrivatecontent:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.privatecontent,success:function(t){var e=t.result;$(".privatecontent-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("privatecontentList",{list:e},(new Date).getTime()+6e4)}})},getTopSong:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.topSong,success:function(t){var e=[{ftype:0,list:(e=t.data.slice(0,10)).slice(0,5)},{ftype:0,list:e.slice(5,10)}];$(".newest-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("newestList",{list:e},(new Date).getTime()+6e4)}})},getMVList:function(){$.ajax({type:"get",dataType:"json",data:{limit:9},url:apiUrls.home.mv,success:function(t){var e;200==t.code&&(e=t.result.slice(0,3),$(".mv-list").render($(layoutTemp).find("#gridListTemp"),{list:e,category:t.category}),$.$store.set("mvList",{list:e,category:t.category},(new Date).getTime()+6e4))}})},getDjRecommend:function(){$.ajax({type:"get",dataType:"json",data:{limit:5},url:apiUrls.home.djrecommend,success:function(t){var e;200==t.code&&(e=t.djRadios.slice(0,5),$(".dj-list").render($(layoutTemp).find("#gridListTemp"),{list:e,category:t.category}),$.$store.set("djList",{list:e,category:t.category},(new Date).getTime()+6e4))}})},onShow:function(){$(document).on("click",".js-list-detail",function(){var t=$(this).attr("data-id"),e=$(this).attr("data-type"),i=$(this).attr("data-ctype");$.$router.push("/songs/list",{id:t,type:e,ctype:i})})}},a={setLocal:function(){a.resetData();var t=$.$store.get("cateList"),e=$.$store.get("songCateList");return $(".tab-cate-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),e),null!==t&&$(".mask-cate").html(template("cateListTemp",{data:t})),t||e},resetData:function(){$(".tab-cate-content .mask-cate").html(""),$(".tab-cate-content .recommend-list").html("")},init:function(){this.onShow()},getCateList:function(){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.song.catlist,success:function(o){200==o.code&&function(){var i=[],t=(o.sub,o.all),e=o.categories;for(var a in o.categories)!function(e){i[e]=[],o.sub.map(function(t){t.category==e&&i[e].push(t)})}(a);o.subs=i;var n=template("cateListTemp",{data:{subs:i,all:t,categories:e}}),s=template("hotCateTemp",{data:{subs:i[0]}});$(".tab-cate-content .mask-cate").html(n),$(".tab-cate-content .tags .cates").html(s),console.log(s,"hotCateTemp"),$.$store.set("cateList",o,(new Date).getTime()+1e3)}()}})},getRecommend:function(i){$.ajax({type:"get",dataType:"json",data:{limit:50},url:apiUrls.home.personalized,success:function(t){i=i||1;var e=t.result.slice(i-1,50);e.forEach(function(t){t.playCount=$.filterPlayCount(t.playCount)}),a.initPage(50),$(".tab-cate-content .recommend-list").render($(layoutTemp).find("#gridListTemp"),{list:e}),$.$store.set("songCateList",{list:e},(new Date).getTime()+1e3)}})},initPage:function(t){$("#cate-page").Page({totalPages:t,liNums:7,activeClass:"activP",firstPage:"首页",lastPage:"末页",prv:"<",next:">",hasFirstPage:!0,hasLastPage:!0,hasPrv:!0,hasNext:!0,callBack:function(t){a.getRecommend(t)}})},onShow:function(){$(document).on("click",".js-tab-item",function(){$(this).addClass("active").siblings().removeClass("active"),$(".tab-content").eq($(this).index()).show().siblings(".tab-content").hide();var t=$(this).attr("data-type");null==a.setLocal()&&"cate"==t&&(a.resetData(),a.getCateList(),a.getRecommend())}),$(".js-toggle-cate").click(function(){$(this).parent().siblings(".mask-cate").toggleClass("active")})}};e.init(),a.init()});